diff --git a/alphafold/data/pipeline.py b/alphafold/data/pipeline.py
index bae5db0..dce72ea 100644
--- a/alphafold/data/pipeline.py
+++ b/alphafold/data/pipeline.py
@@ -129,7 +129,8 @@ class DataPipeline:
                uniref_max_hits: int = 10000,
                no_templates: bool = False,
                bfd_max_hits: int = 10000,
-               use_precomputed_msas: bool = False):
+               use_precomputed_msas: bool = False,
+               only_msas: bool = False):
     """Initializes the data pipeline."""
     self._use_small_bfd = use_small_bfd
     self.jackhmmer_uniref90_runner = jackhmmer.Jackhmmer(
@@ -153,6 +154,7 @@ class DataPipeline:
     self.no_templates=no_templates
     self.bfd_max_hits = bfd_max_hits
     self.use_precomputed_msas = use_precomputed_msas
+    self.only_msas = only_msas
 
   def process(self, input_fasta_path: str, msa_output_dir: str) -> FeatureDict:
     """Runs alignment tools on the input sequence and creates features."""
@@ -167,6 +169,7 @@ class DataPipeline:
     num_res = len(input_sequence)
 
     uniref90_out_path = os.path.join(msa_output_dir, 'uniref90_hits.sto')
+
     jackhmmer_uniref90_result = run_msa_tool(
         msa_runner=self.jackhmmer_uniref90_runner,
         input_fasta_path=input_fasta_path,
@@ -183,6 +186,41 @@ class DataPipeline:
         use_precomputed_msas=self.use_precomputed_msas,
         max_sto_sequences=self.mgnify_max_hits)
 
+    # This step has been moved here to generate the msas files to avoid some computions
+    # done twice (typically when --only_msas is True and then when --use_precomputed_msas is True
+    if self._use_small_bfd:
+      bfd_out_path = os.path.join(msa_output_dir, 'small_bfd_hits.sto')
+      jackhmmer_small_bfd_result = run_msa_tool(
+          msa_runner=self.jackhmmer_small_bfd_runner,
+          input_fasta_path=input_fasta_path,
+          msa_out_path=bfd_out_path,
+          msa_format='sto',
+          use_precomputed_msas=self.use_precomputed_msas,
+          max_sto_sequences=self.bfd_max_hits)
+      # This step below will be done bwlo when --only_msas is False
+      #bfd_msa = parsers.parse_stockholm(jackhmmer_small_bfd_result['sto'])
+    else:
+      bfd_out_path = os.path.join(msa_output_dir, 'bfd_uniref_hits.a3m')
+      hhblits_bfd_uniref_result = run_msa_tool(
+          msa_runner=self.hhblits_bfd_uniref_runner,
+          input_fasta_path=input_fasta_path,
+          msa_out_path=bfd_out_path,
+          msa_format='a3m',
+          use_precomputed_msas=self.use_precomputed_msas,
+          max_sto_sequences=self.bfd_max_hits)
+      # This step below will be done bwlo when --only_msas is False
+      #bfd_msa = parsers.parse_a3m(hhblits_bfd_uniref_result['a3m'])
+
+    # If --only_msas is True, exit here after the files have been witten in the output_dir
+    if self.only_msas:
+        return
+    
+    # If --only_msas is False, perform the two steps mentioned above:
+    if self._use_small_bfd:
+      bfd_msa = parsers.parse_stockholm(jackhmmer_small_bfd_result['sto'])
+    else:
+      bfd_msa = parsers.parse_a3m(hhblits_bfd_uniref_result['a3m'])
+
     msa_for_templates = jackhmmer_uniref90_result['sto']
     msa_for_templates = parsers.deduplicate_stockholm_msa(msa_for_templates)
     msa_for_templates = parsers.remove_empty_columns_from_stockholm_msa(
@@ -212,27 +250,6 @@ class DataPipeline:
       pdb_template_hits = self.template_searcher.get_template_hits(
         output_string=pdb_templates_result, input_sequence=input_sequence)
 
-    if self._use_small_bfd:
-      bfd_out_path = os.path.join(msa_output_dir, 'small_bfd_hits.sto')
-      jackhmmer_small_bfd_result = run_msa_tool(
-          msa_runner=self.jackhmmer_small_bfd_runner,
-          input_fasta_path=input_fasta_path,
-          msa_out_path=bfd_out_path,
-          msa_format='sto',
-          use_precomputed_msas=self.use_precomputed_msas,
-          max_sto_sequences=self.bfd_max_hits)
-      bfd_msa = parsers.parse_stockholm(jackhmmer_small_bfd_result['sto'])
-    else:
-      bfd_out_path = os.path.join(msa_output_dir, 'bfd_uniref_hits.a3m')
-      hhblits_bfd_uniref_result = run_msa_tool(
-          msa_runner=self.hhblits_bfd_uniref_runner,
-          input_fasta_path=input_fasta_path,
-          msa_out_path=bfd_out_path,
-          msa_format='a3m',
-          use_precomputed_msas=self.use_precomputed_msas,
-          max_sto_sequences=self.bfd_max_hits)
-      bfd_msa = parsers.parse_a3m(hhblits_bfd_uniref_result['a3m'])
-
     templates_result = self.template_featurizer.get_templates(
         query_sequence=input_sequence,
         hits=pdb_template_hits)
diff --git a/alphafold/data/tools/hhblits.py b/alphafold/data/tools/hhblits.py
index 53a44b0..6014513 100644
--- a/alphafold/data/tools/hhblits.py
+++ b/alphafold/data/tools/hhblits.py
@@ -35,7 +35,7 @@ class HHBlits:
                *,
                binary_path: str,
                databases: Sequence[str],
-               n_cpu: int = 4,
+               n_cpu: int = os.getenv('AF_HHBLITS_N_CPU', 4),
                n_iter: int = 3,
                e_value: float = 0.001,
                maxseq: int = 1_000_000,
diff --git a/alphafold/data/tools/jackhmmer.py b/alphafold/data/tools/jackhmmer.py
index 68997f8..1ae1af8 100644
--- a/alphafold/data/tools/jackhmmer.py
+++ b/alphafold/data/tools/jackhmmer.py
@@ -35,7 +35,7 @@ class Jackhmmer:
                *,
                binary_path: str,
                database_path: str,
-               n_cpu: int = 8,
+               n_cpu: int = os.getenv('AF_JACKHMMER_N_CPU', 8),
                n_iter: int = 1,
                e_value: float = 0.0001,
                z_value: Optional[int] = None,
diff --git a/run_alphafold.py b/run_alphafold.py
index 92c231b..c2278d4 100644
--- a/run_alphafold.py
+++ b/run_alphafold.py
@@ -159,7 +159,7 @@ flags.DEFINE_list('models_to_use',None, 'specify which models in model_preset th
                   'for monomer_ptm as model_X_ptm, with X the number of the model, '
                   'for multimer as model_X_multimer_vY with X the number of the model and Y '
                   ' the version of the model.')
-flags.DEFINE_boolean('alignments_only', False, 'Whether to generate only alignments. '
+flags.DEFINE_boolean('only_msas', False, 'Whether to generate only alignments. '
                      'Only alignments will be generated by the data pipeline, '
                      'the modelling will not be performed')
 flags.DEFINE_boolean('no_templates',False, 'will not use any template, will be faster than filter by date')
@@ -205,7 +205,7 @@ def predict_structure(
     benchmark: bool,
     random_seed: int,
     models_to_relax: ModelsToRelax,
-    alignments_only: bool):
+    only_msas: bool):
   """Predicts structure using AlphaFold for the given sequence."""
   logging.info('Predicting %s', fasta_name)
   timings = {}
@@ -223,8 +223,8 @@ def predict_structure(
       msa_output_dir=msa_output_dir)
   timings['features'] = time.time() - t_0
 
-  if alignments_only:
-    logging.info('Alignments have been generated, stopping now.')
+  if only_msas:
+    logging.info('Options only_msas: process is now completed.')
     return
 
   # Write out features as a pickled dictionary.
@@ -429,7 +429,8 @@ def main(argv):
       use_precomputed_msas=FLAGS.use_precomputed_msas,
       mgnify_max_hits=FLAGS.mgnify_max_hits,
       uniref_max_hits=FLAGS.uniref_max_hits,
-      bfd_max_hits=FLAGS.bfd_max_hits)
+      bfd_max_hits=FLAGS.bfd_max_hits,
+      only_msas=FLAGS.only_msas)
 
   num_predictions_per_model = FLAGS.num_predictions_per_model
   if run_multimer_system:
@@ -439,7 +440,8 @@ def main(argv):
         jackhmmer_binary_path=FLAGS.jackhmmer_binary_path,
         uniprot_database_path=FLAGS.uniprot_database_path,
         use_precomputed_msas=FLAGS.use_precomputed_msas,
-        max_uniprot_hits=FLAGS.uniprot_max_hits)
+        max_uniprot_hits=FLAGS.uniprot_max_hits,
+        only_msas=FLAGS.only_msas)
   else:
     data_pipeline = monomer_data_pipeline
 
@@ -509,8 +511,7 @@ def main(argv):
         benchmark=FLAGS.benchmark,
         random_seed=random_seed,
         models_to_relax=FLAGS.models_to_relax,
-        alignments_only=FLAGS.alignments_only)
-
+        only_msas=FLAGS.only_msas)
 
 if __name__ == '__main__':
   flags.mark_flags_as_required([
