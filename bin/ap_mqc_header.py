#!/usr/bin/env python
# coding: utf-8

#############################################################################################
# Copyright Institut Curie 2020                                                             #
#                                                                                           #
# This software is a computer program whose purpose                                         #
# is to analyze high-throughput sequencing data.                                            #
# You can use, modify and/ or redistribute the software under                               #
# the terms of license (see the LICENSE file for more details).                             #
# The software is distributed in the hope that it will be useful,                           #
# but "AS IS" WITHOUT ANY WARRANTY OF ANY KIND.                                             #
# Users are therefore encouraged to test the software's suitabilityas regards               #
# their requirements in conditions enabling the security of their systems and/or data.      #
# The fact that you are presently reading this means that                                   #
# you have had knowledge of the license and that you accept its terms.                      #
#############################################################################################

""" Generate header information for multiqc report """

import os
import re
import argparse

parser = argparse.ArgumentParser()
parser.add_argument("-n", "--name", help="Pipeline name", type=str, default='')
parser.add_argument("-v",
                    "--version",
                    help="Pipeline version",
                    type=str,
                    default='')
parser.add_argument("-c",
                    "--condition",
                    help="Information about the experimental condition",
                    type=str,
                    default='')

args = parser.parse_args()

##
## Header
##

multiqc_list = [f"title: '{args.name}'"]
multiqc_list += [f"subtitle: {args.condition}"]
multiqc_list += [
    f"""intro_text: >\n This report has been generated by the {args.name}
    pipeline (version: {args.version})"""
]

if re.match(r".*dev(el)?$", args.version):
    multiqc_list += [
        """report_comment: >\n This software is currently under active development
        and the results have been generated with a non stable version.
        The reliability, reproducibility and the quality of the results
        are therefore not guaranteed."""
    ]

CUSTOM_LOGO_PATH = os.sep.join(
    [os.path.dirname(os.path.realpath(__file__)), '../assets/Curie-CUBIC.png'])
multiqc_list += [f"custom_logo: '{CUSTOM_LOGO_PATH}'"]
multiqc_list += ["custom_logo_title: Institut Curie"]
multiqc_list += [
    "custom_logo_url: https://curie.fr/plateforme/curiecoretech-bioinformatique-cubic"
]

## Output
CUSTOM_CONTENT = '\n'.join(multiqc_list)
print(CUSTOM_CONTENT)
